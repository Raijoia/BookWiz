USE DB_BOOKWIZ;
SELECT * FROM TB_USER;
INSERT INTO TB_USER (USU_NOME, USU_IDADE, USU_SEXO, USU_EMAIL, USU_SENHA, USU_PREF) values ('Bruno Trova', 18, 'Masculino', 'brunotrova@gmail.com', '1234', '1');
drop table TB_LIVRO;

CREATE TABLE TB_USER(
	USU_ID INT AUTO_INCREMENT PRIMARY KEY NOT NULL,
    USU_NOME VARCHAR(200) NOT NULL,
    USU_PREF INT NOT NULL,
    USU_IDADE INT NOT NULL,
    USU_EMAIL VARCHAR(200) NOT NULL,
    USU_SEXO VARCHAR(200) NOT NULL,
    USU_ATIVO INT DEFAULT 1,
    USU_SENHA VARCHAR(200) NOT NULL
);

CREATE TABLE TIPO_USU(
	TP_ID INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    TP_DESC VARCHAR(200) NOT NULL
);

CREATE TABLE TB_NOTA(
	NOTA_ID INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    NOTA_DESC VARCHAR(200) NOT NULL
);

CREATE TABLE TB_GEN (
	GEN_ID INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    GEN_DESC VARCHAR(200) NOT NULL
);

CREATE TABLE TB_LIVRO (
	LV_ID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    LV_TITULO VARCHAR(200) NOT NULL,
    LV_AUTOR VARCHAR(200) NOT NULL,
    LV_GEN VARCHAR(200) NOT NULL,
    LV_DTCAD DATETIME NOT NULL,
    LV_DESC VARCHAR(1000) NOT NULL
);

CREATE TABLE TB_AVA (
	AVA_ID INT AUTO_INCREMENT PRIMARY KEY NOT NULL,
	AVA_DESC VARCHAR(200) NOT NULL, 
    USU_ID INT NOT NULL,
    LV_ID INT NOT NULL,
	FOREIGN KEY (USU_ID) REFERENCES TB_USER(USU_ID),
    FOREIGN KEY (LV_ID) REFERENCES TB_LIVRO(LV_ID)
);

ALTER TABLE TB_LIVRO ADD AVA_ID INT NOT NULL;
ALTER TABLE TB_LIVRO ADD FOREIGN KEY (AVA_ID) REFERENCES TB_AVA(AVA_ID);

ALTER TABLE TB_USER ADD AVA_ID INT NOT NULL;
ALTER TABLE TB_USER ADD FOREIGN KEY (AVA_ID) REFERENCES TB_AVA(AVA_ID);
ALTER TABLE TB_USER ADD TP_ID INT NOT NULL;
ALTER TABLE TB_USER ADD FOREIGN KEY (TP_ID) REFERENCES TIPO_USU(TP_ID);